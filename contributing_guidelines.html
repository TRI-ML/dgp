<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Contribution Guidelines &#8212; DGP 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/tri_colors.css" />
    <link rel="stylesheet" type="text/css" href="_static/tri_colors.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="TRI Dataset Governance Policy (DGP) Schema" href="dgp_schema.html" />
    <link rel="prev" title="Getting Started" href="getting_started.html" /><link href='http://fonts.googleapis.com/css?family=Source+Code+Pro|Open+Sans:300italic,400italic,700italic,400,300,700' rel='stylesheet' type='text/css'>
<link href="_static/solarized-dark.css" rel="stylesheet">
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="dgp_schema.html" title="TRI Dataset Governance Policy (DGP) Schema"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="getting_started.html" title="Getting Started"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">DGP 1.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Contribution Guidelines</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><!DOCTYPE html>
<hr />
<p>
<h2 class="logo">
    <a href="https://www.tri.global/">
        <img src="_static/tri_logo.png" alt="TRI">
    </a>
</h2>
</p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script><!DOCTYPE html>
<h3><a href="#">Quick Links</a></h3>
<ul>
    <li><a class="reference internal" href="cli.html">Command Line Interface Info</a></li>
    <li><a class="reference internal" href="getting_started.html">Getting Started</a></li>
    <li><a class="reference internal" href="contributing_guidelines.html">Contributing Guidelines</a></li>
    <li><a class="reference internal" href="dgp_schema.html">DGP Schema</a></li>
</ul>
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Contribution Guidelines</a><ul>
<li><a class="reference internal" href="#clone-the-repository">Clone the repository</a></li>
<li><a class="reference internal" href="#getting-started">Getting started</a></li>
<li><a class="reference internal" href="#gitworkflow">GitWorkflow</a><ul>
<li><a class="reference internal" href="#starting-a-new-branch">Starting a new branch</a></li>
<li><a class="reference internal" href="#making-a-commit">Making a commit</a></li>
<li><a class="reference internal" href="#pre-commit-pre-push">Pre-commit / Pre-push</a></li>
<li><a class="reference internal" href="#making-a-pull-request">Making a pull request</a></li>
<li><a class="reference internal" href="#review">Review</a></li>
<li><a class="reference internal" href="#merging">Merging</a></li>
<li><a class="reference internal" href="#code-style">Code Style</a></li>
<li><a class="reference internal" href="#test-coverage-policy">Test Coverage Policy</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="getting_started.html"
                        title="previous chapter">Getting Started</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="dgp_schema.html"
                        title="next chapter">TRI Dataset Governance Policy (DGP) Schema</a></p>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="contribution-guidelines">
<h1>Contribution Guidelines<a class="headerlink" href="#contribution-guidelines" title="Permalink to this headline">¶</a></h1>
<p>Welcome to <code class="docutils literal notranslate"><span class="pre">TRI-ML/dgp</span></code>! This page details contribution guidelines and GitWorkflow.</p>
<div class="section" id="clone-the-repository">
<h2>Clone the repository<a class="headerlink" href="#clone-the-repository" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Fork <code class="docutils literal notranslate"><span class="pre">TRI-ML/dgp</span></code> into your GitHub account.</p></li>
<li><p>Clone your fork <code class="docutils literal notranslate"><span class="pre">&lt;your-user-name&gt;/dgp</span></code> on your local machine.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">upstream</span></code> remote:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">dgp</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">remote</span> <span class="pre">add</span> <span class="pre">upstream</span> <span class="pre">git&#64;github.com:TRI-ML/dgp.git</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">remote</span> <span class="pre">set-url</span> <span class="pre">--push</span> <span class="pre">upstream</span> <span class="pre">no_push</span></code></p></li>
</ul>
</li>
<li><p>Enable githooks (linting, autoformatting) via:</p></li>
</ol>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>dgp$ make link-githooks
</pre></div>
</div>
</div>
<div class="section" id="getting-started">
<h2>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>Please follow <a class="reference external" href="GETTING_STARTED.md">Getting Started</a> to setup dockerized development workflow.</p>
</div>
<div class="section" id="gitworkflow">
<h2>GitWorkflow<a class="headerlink" href="#gitworkflow" title="Permalink to this headline">¶</a></h2>
<p>This section assumes you have followed the initial setup instructions and enable the githooks.</p>
<div class="section" id="starting-a-new-branch">
<h3>Starting a new branch<a class="headerlink" href="#starting-a-new-branch" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">fetch</span> <span class="pre">upstream</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">-b</span> <span class="pre">my_pr_branch</span> <span class="pre">upstream/master</span></code></p></li>
</ol>
</div>
<div class="section" id="making-a-commit">
<h3>Making a commit<a class="headerlink" href="#making-a-commit" title="Permalink to this headline">¶</a></h3>
<p>There should only be a single commit with all the changes when making a pull request. Please squash the commits before opening a PR.
This repository follows <a class="reference external" href="https://www.conventionalcommits.org/en/v1.0.0/">Conventional Commits 1.0.0</a> for the commit message convention. All commit messages will be verified by <a class="reference external" href="https://github.com/conventional-changelog/commitlint">commitlint</a>.</p>
<p>The commit message should be structured as follows:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>&lt;type&gt;: &lt;description&gt;

<span class="o">[</span>optional body<span class="o">]</span>

<span class="o">[</span>optional footer<span class="o">(</span>s<span class="o">)]</span>
</pre></div>
</div>
<p>When naming the commit, the first line (commit title) should be a short summary <strong>in ALL lowercase</strong> and starts with a <code class="docutils literal notranslate"><span class="pre">type</span></code>. <a class="reference external" href="https://github.com/conventional-changelog/commitlint/tree/master/&#64;commitlint/config-conventional#type-enum">Common types</a> can be:</p>
<ul class="simple">
<li><p><cite>schema</cite>: changes to dgp [protobuf schema](<a class="reference external" href="https://github.com/TRI-ML/dgp/tree/master/dgp/proto">https://github.com/TRI-ML/dgp/tree/master/dgp/proto</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">feat</span></code>: introduce new features</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fix</span></code>: bugfix</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">test</span></code>: changes to unit tests</p></li>
<li><p><cite>build</cite>: changes that affect the package build or external dependencies (example: requirement.txt and Dockerfile updates)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">docs</span></code>: documentation only changes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ci</span></code>: changes to CI/CD configuration files and settings</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">style</span></code>: changes that do not affect the meaning of the code (formatting, linting, etc)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">refactor</span></code>: a code change that neither fixes a bug nor adds a feature</p></li>
<li><p><cite>perf</cite>: changes that improve performance (example: speed up dataset index building)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">revert</span></code>: revert a commit</p></li>
</ul>
<p>For example, adding a new PyTorch DatasetClass:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>feat: add synchronized datasetclass

- add synchronized datasetclass to load time-synchronized samples
- speed up build_item_index
</pre></div>
</div>
<p>Add new protobuf schema:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>schema: add map schema

- add protobuf schema <span class="k">for</span> map
- modify dgp.proto.dataset to hold map message
</pre></div>
</div>
<p><strong>NOTE:</strong> For adding any new <a class="reference external" href="../dgp/proto">proto schema</a>, please run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">build-proto</span></code> and also commit the compiled protos. Further, these <a class="reference external" href="../dgp/proto">proto schema</a> and their compiled protos must be separated from code changes into one independent commit and PR.</p>
</div>
<div class="section" id="pre-commit-pre-push">
<h3>Pre-commit / Pre-push<a class="headerlink" href="#pre-commit-pre-push" title="Permalink to this headline">¶</a></h3>
<p>DGP runs <code class="docutils literal notranslate"><span class="pre">isort</span></code> and <code class="docutils literal notranslate"><span class="pre">yapf</span></code> to autoformat the files in pre-commit, and perform additional linting using <code class="docutils literal notranslate"><span class="pre">pylint</span></code> in pre-push. One can enable githooks via:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>dgp$ make link-githooks
</pre></div>
</div>
</div>
<div class="section" id="making-a-pull-request">
<h3>Making a pull request<a class="headerlink" href="#making-a-pull-request" title="Permalink to this headline">¶</a></h3>
<p>Please follow this procedure to open a pull request. Also note, the git hooks require that tools such as isort and yapf are installed on the machine doing the git push. If these are not available on your system, you will first need to install them, ideally in the <a class="reference external" href="GETTING_STARTED.md#markdown-develop-within-docker">docker container</a> or in a <a class="reference external" href="VIRTUAL_ENV.md">virtual environment</a>.</p>
<p>All changes require unit tests. PRs can only be merged if the code coverage score is greater than the minimum acceptable code coverage. The minimum acceptable code coverage score is set <a class="reference external" href="https://github.com/TRI-ML/dgp/blob/master/.github/workflows/coverage.yml#L15">here</a>.</p>
<ol class="arabic simple">
<li><p>Rebase to master</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">fetch</span> <span class="pre">upstream</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rebase</span> <span class="pre">upstream/master</span></code></p></li>
</ul>
</li>
<li><p>Push to your GitHub fork</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">origin</span></code></p></li>
</ul>
</li>
<li><p>Create “Pull Request” (PR)</p>
<ul class="simple">
<li><p>Go to your fork in GitHub and create a pull request per <a class="reference external" href="https://docs.github.com/en/github/collaborating-with-issues-and-pull-requests/creating-a-pull-request">these instructions</a></p></li>
</ul>
</li>
<li><p>CI coverage</p>
<ul class="simple">
<li><p>You can run unittests via <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">docker-run-tests</span></code>.</p></li>
<li><p>You can make PRs with no reviewers to get CI coverage.</p></li>
<li><p>All pull requests must pass certain stages in order to be merged:</p>
<ul>
<li><p>Build &amp; unit tests via <a class="reference external" href="https://github.com/TRI-ML/dgp/actions/workflows/pre-merge.yml">pre-merge</a> workflow.</p></li>
<li><p>Linting/formatting checks via <a class="reference external" href="https://github.com/TRI-ML/dgp/actions/workflows/pre-merge.yml">pre-merge</a> workflow.</p></li>
<li><p>Code coverage metrics verification via <a class="reference external" href="https://github.com/TRI-ML/dgp/actions/workflows/coverage.yml">coverage</a> workflow.</p></li>
</ul>
</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="review">
<h3>Review<a class="headerlink" href="#review" title="Permalink to this headline">¶</a></h3>
<p>The pull request has a reviewable.io review associated with it. (You will need to reload the pull request page before the reviewable.io button appears). Please add at least one reviewer to review.
Note: Any <a class="reference external" href="../dgp/proto">proto schema</a> changes require <strong>*at least 2 reviewers.</strong>_</p>
</div>
<div class="section" id="merging">
<h3>Merging<a class="headerlink" href="#merging" title="Permalink to this headline">¶</a></h3>
<p>Once all reviews are complete, and all checks have completed with passing scores, the author can click the button <code class="docutils literal notranslate"><span class="pre">Squash</span> <span class="pre">&amp;</span> <span class="pre">Merge</span></code> to merge the PR.</p>
</div>
<div class="section" id="code-style">
<h3>Code Style<a class="headerlink" href="#code-style" title="Permalink to this headline">¶</a></h3>
<p>Docstrings should follow the <a class="reference external" href="https://numpydoc.readthedocs.io/en/latest/format.html#docstring-standard">Numpy Docstring Standard</a></p>
</div>
<div class="section" id="test-coverage-policy">
<h3>Test Coverage Policy<a class="headerlink" href="#test-coverage-policy" title="Permalink to this headline">¶</a></h3>
<p>All commits (except protobuf schema changes) should include test cases. Test cases should be based on pytest. PRs can only be merged if the code coverage score is greater than the minimum acceptable code coverage.</p>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="dgp_schema.html" title="TRI Dataset Governance Policy (DGP) Schema"
             >next</a> |</li>
        <li class="right" >
          <a href="getting_started.html" title="Getting Started"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">DGP 1.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Contribution Guidelines</a></li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2021, Toyota Research Institute.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 4.2.0.Theme is <a href="http://github.com/vimalkvn/solar-theme">Solar</a>
    </div>
  </body>
</html>